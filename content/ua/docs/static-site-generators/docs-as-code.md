---
title: "Підхід docs-as-code для створення документації на прикладі генератора статичних сайтів Docusaurus"
linkTitle: "Docs-as-code для документації на прикладі Docusaurus"
weight: 6
description: >
  У цій статті я розповім про підхід docs-as-code (документація як код) для створення документації у вигляді статичного сайта за допомогою Docusaurus — генератора статичних сайтів (static site generator). Окрім загальної інформації про сучасний підхід до створення документації, я пропоную покрокову інструкцію, як створити сайт із документацією без знання мови програмування, а також опублікувати цей сайт в інтернеті.
---

{{% pageinfo %}}
Стаття адресована насамперед техрайтерам, але буде корисною також для команд розробників, які шукають спосіб створення внутрішнього або зовнішнього сайта з документацією для програмного продукту.
{{% /pageinfo %}}

У цій статті ви дізнаєтесь:

* Що таке підхід docs-as-code

* Як швидко створити сайт із документацією за допомогою генератора статичних сайтів Docusaurus

* Як налаштувати зовнішній вигляд сайта з документацією

* Як створювати та редагувати статті документації на сайті

* Як безкоштовно опублікувати сайт із документацією в інтернеті

* Як налаштувати CI/CD пайплайн для автоматизації публікації змін на сайті

---

## Docs-as-code

Підхід до створення документації _docs-as-code_ (документація як код) набуває все більшого поширення серед техрайтерів та інших спеціалістів, які пишуть документацію для програмних продуктів. Спочатку розберемося, що означає це поняття.

Досвідчений техрайтер Google Том Джонсон у своєму блозі [зазначає](https://idratherbewriting.com/learnapidoc/pubapis_docs_as_code.html): «Ставитись до документації як коду — означає використовувати ті самі системи, процеси та послідовність виконуваних дій з документацією, які ви використовуєте з програмним кодом». Він наводить такі ознаки підходу _docs-as-code_:

* **Робота з файлами у форматі «легкої» (lightweight) або «читабельної» (plain) розмітки.** Це насамперед Markdown (.md) — найбільш поширений формат вихідного коду документації для docs-as-code. Маркдаун — дійсно простий і читабельний формат розмітки. Наприклад, виділення жирним шрифтом робиться за допомогою двох зірочок ** на початку та в кінці слова або фрази, які потрібно виділити жирним. Таким чином файли у форматі Маркдаун можна прочитати у вихідному коді документації навіть до конвертації в HTML. Для цього не потрібний WYSIWYG редактор, що конвертує складний для прочитання код XML, як це робить Word або MadCap Flare.

* Використання open-source (безкоштовного) генератора статичних сайтів. На сьогодні існують десятки безкоштовних генераторів статичних сайтів з відкритим кодом. Це означає, що їхній код можна завантажити собі на комп’ютер із відкритого репозиторія в GitHub, побудувати сайт локально, щоб автоматично отримати HTML-сторінки з додаванням CSS-стилів для кольорової теми, JS-елементів тощо. Ці сторінки можна завантажити на вебсервер, щоб зібраний сайт був доступний в інтернеті. Серед найбільш відомих генераторів статичних сайтів такі: Jekyll, Hugo, Gatsby, Next.js тощо. Перелік досить довгий. Більше можна знайти на сайті Jamstack. Генератори можна використовувати не тільки для створення сайтів із документацією, але насамперед для блогів, лендингів тощо.

* Робота з файлами за допомогою текстового редактора. Техрайтери, які працюють за принципом docs-as-code, використовують редактори коду (IDE), якими користуються й розробники. Це може бути Visual Studio Code, WebStorm, PyCharm та інші редактори коду. У цих редакторах можна працювати з файлами у форматі Маркдаун і одночасно мати попередній перегляд кінцевого результату в HTML. Крім того, можна користуватися багатьма розширеннями, що спрощують роботу з гітом: перевірка правопису тощоі.

* Зберігання документації в репозиторії системи контролю версій. Як і розробники, техрайтери комітять (commit — фіксація змін) зміни до коду документації локально та пушать (push — передача змін на сервер) ці зміни в гіт сервер у GitHub, GitLab, Bitbucket або іншу систему контролю версій (VCS). Крім відомих переваг системи контролю версій, як-от відстежування змін за допомогою діффів (diff or difference — візуальне виділення різниці між поточною і попередньою версіями файла), репозиторій гіт може використовуватись у CI/CD пайплайні для збирання та публікації сайта.

* Спільна робота над документацією в репозиторії гіта команди техрайтерів. Як і розробники, команда техрайтерів спільно працює над проєктом сайта з документацією: роблять master і develop гілки, виводять фіча бранчі (feature branch — гілка для роботи над окремою функціональністю, що у випадку документації може бути окрема стаття на сайті з документацією), створюють мердж ріквести (merge request — запит на об’єднання змін із фіча гілки в develop після закінчення написання статті) і код рев’ю лідом.
•	Автоматизація процесу побудови та публікації сайта з документацію за допомогою пайплайна CI/CD. Зазвичай процес автоматичного будування сайта з документацією та публікації (deploy) на вебсервер налаштовуються спеціалістами devops або system engineers. Такі спеціалісти створюють скрипт із усіма кроками й командами генерації статичного сайта: після пуша змін у master гілку автоматично запускається скрипт, що виконує команди будування сайта на сервері та деплоїть згенеровані HTML-сторінки разом з усіма стилями CSS й елементами JS у вигляді статичного сайта з документацією.
•	Запуск тестів документації. Як і розробники, техрайтери тестують документацію на відповідність певним вимогам: відсутність неробочих посилань, лінтер Vale з правилами перевірки на відповідність вимогам стайлгайдів Майкрософт, Гугл і власних стайлгайдів. Про це я писав у попередній статті.
•	Управління процесами створення та оновлення документації за методологіями Scrum, Agile, Kanban. Як і розробники, техрайтери працюють за спринтами (sprint — період, що зазвичай триває один місяць, за який розробники поставляють частину розробленої функціональності для демонстрації замовнику виконаної роботи). Техрайтери використовують Jira або інший трекер задач і проводять відповідні Scrum-церемонії (daily standup, Sprint Planning, Retro тощо). Часто техрайтери лінкують у джирі свої задачі з документування фіч до задач розробників.
Отже, ми з’ясували, що процес розробки сайта з документацією загалом схожий на процес розробки коду. Далі спробуємо на практиці встановити потрібні інструменти docs-as-code, згенерувати сайт з документацією та опублікувати його в інтернеті.


## Що таке лінтери?

Лінтер *(англ. linter або lint)* — інструмент автоматичного аналізу коду на відповідність певним вимогам і правилам: синтаксис, стилістика тощо. Цей термін вигадав у 1978 р. програміст [Стівен Джонсон](https://en.wikipedia.org/wiki/Stephen_C._Johnson) для пошуку помилок у коді мови С. У буквальному сенсі лінт — це частинки волокон тканини з бавовни. Стівен порівняв такі частинки, що утворюються під час прання одягу та повинні осідати у фільтрі сушильної машини, з невеличкими помилками в коді, що призводять до серйозних проблем під час компіляції.

Сучасні розробники коду широко використовують лінтери для дотримання норм синтаксису певних мов програмування, а також для виявлення неправильних конструкцій, що призводять до помилок у коді. ESLint — один з найбільш використовуваних лінтерів для мови JavaScript: за перші місяці 2021 р. цей інструмент завантажували більш ніж [16 млн користувачів на тиждень](https://www.npmtrends.com/jslint-vs-jshint-vs-eslint-vs-tslint-vs-@typescript-eslint/eslint-plugin).

А тепер найцікавіше — існують лінтери не тільки для коду, але і для текстів. Один з таких лінтерів — це Vale. Цей інструмент створив розробник [Джозеф Като](https://github.com/jdkato) для мов з розміткою: Markdown, HTML тощо. Техрайтери використовують лінтер Vale для перевірки текстів на відповідність вимогам стайлгайдів: Microsoft, Google тощо.

## Vale

Лінтер [Vale](https://docs.errata.ai/vale/about) — це інструмент, що працює за допомогою командного рядка й перевіряє тексти на відповідність вимогам стайлгайдів або ваших власних правил. Для тих, хто не любить працювати з командним рядком, є комерційний варіант цього інструмента — [Vale Server](https://errata.ai/vale-server/). Однак у цій статті мова піде саме про [безкоштовну версію](https://github.com/errata-ai/vale) лінтера Vale.

Спочатку розберемося, як це працює.

### Попередні вимоги

1. У вас є тексти у форматі Markdown (також підтримуються HTML, reStructuredText, AsciiDoc, DITA, XML). Більше про [підтримку форматів](https://docs.errata.ai/vale/scoping#formats), з якими працює Vale.

2. Вам потрібно перевірити текст у файлах Markdown на відповідність вимогам стайлгайдів Майкрософт, Гугл.

3. Завантажте папку [styles](https://github.com/ivancheban/docsy-site/tree/master/styles) із правилами стайлгайдів із [репозиторія GitHub](https://github.com/ivancheban/docsy-site).

4. Завантажте файл з конфігурацією [.vale.ini](https://github.com/ivancheban/docsy-site/blob/master/.vale.ini).

5. Покладіть папку **styles** і файл з конфігурацією **.vale.ini** в корінь вашого проекта з файлами Markdown, які потрібно перевірити. Зазвичай це папка вашого проекта з документацією.

    ![img](/docs/img/test-vale.png)

6.	Установіть Vale: [інструкції зі встановлення](https://docs.errata.ai/vale/install). Щоб перевірити, чи встановлено Vale: `vale --v`.

    ![img](/docs/img/vale-v.png)

### Використання Vale

Перейдемо до перевірки файлів Markdown. Я поклав у тестову папку test-vale один файл у форматі Markdown — **jekyll.md**. Це моя [стаття](https://docsy-site.netlify.app/docs/static-site-generators/jekyll/) про генератор статичних файлів Jekyll. Я хочу перевірити, наскільки в цій статті я дотримувався рекомендацій стайлгайдів Майкрософт і Гугл. Ну що, поїхали?

Можна скористатися командним рядком, але там не так красиво підсвічуються помилки та зауваження стайлгайдів.

![img](/docs/img/vale-cmd.png)

Я використовую редактор коду VSCode для написання та редагування статей у форматі Markdown. У VSCode процес перевірки виглядає набагато краще.

1. У VSCode відкрийте папку проекта.

2. У терміналі VSCode введіть:

```sh
vale filename.md
```

де `filename.md` — ваш файл у форматі Markdown, який потрібно перевірити.

![img](/docs/img/vale-jekyll.png)

Як бачимо, у терміналі VSCode виводяться попередження (warning) жовтим кольором і помилки (error) червоним. Також указані рядки, у яких знайдено помилки. Наприклад, в 11-му рядку (11:1) я вжив займенник our (*Our goal is…*). Написання від першої особи множини (*we, our, us, let’s*) — це не помилка, але й не рекомендується відповідно до стайлгайдів [Майкрософт](https://docs.microsoft.com/en-us/style-guide/grammar/person#avoid-first-person-plural) і [Гугл](https://developers.google.com/style/pronouns#personal-pronouns). Натомість стайлгайди рекомендують використовувати другу особу (*you, your*): *Your goal is…*

Звісно, що вирішувати вам: дослухатися до рекомендацій стайлгайдів або писати, як вважаєте за краще самі. Іноді трапляються *false positives* — хибні спрацьовування, коли помилки немає. Однак головна мета цієї перевірки — привернути вашу увагу до потенційної проблеми. Наведу ще один приклад, де вже не попередження, а червона помилка.

![img](/docs/img/vale-terminal.png)

Тут у 54-му рядку я написав: *… let's assume that we have Ruby installed.* Майкрософт [рекомендує](https://docs.microsoft.com/en-us/style-guide/word-choice/use-contractions) писати скорочення *we’ve* замість *we have*.

### Розширення Vale для VSCode

Замість того, щоб вводити в терміналі VSCode команду `vale filename.md` щоразу, коли вам потрібно перевірити файл у форматі Markdown на відповідність вимогам стайлгайдів, установіть розширення (extension) Vale для VSCode.

1. У розділі розширень VSCode знайдіть і установіть розширення Vale.

2. Налаштуйте конфігурацію розширення:

    a. Виберіть **Use Vale’s CLI instead of Vale Server**.

    b. Введіть шлях до папки проекта, де лежить файл **.vale.ini**. У моєму випадку це: `c:\Users\ivanc\test-vale`.

    c. У **Vale CLI: Path** введіть `vale`.

    ![img](/docs/img/vale-extension-config.png)


Тепер Vale буде перевіряти всі файли у форматі Markdown, які ви відкриваєте в редакторі VSCode. Розширення буде посилатися на папку **styles** і файл конфігурації **.vale.ini**, але тепер не треба копіювати ці файли до будь-якого проекта з файлами Markdown для перевірки.

Сама перевірка буде здійснюватись автоматично, коли ви відкриєте будь-який файл Markdown у VSCode. Vale буде підкреслювати слова, у яких знайдено проблеми. Ви можете навести курсор на це підкреслення або перейти на вкладку PROBLEMS у терміналі VSCode.

![img](/docs/img/vale-problems.png)

Можна також переглянути правило відповідного стайлгайда, якщо вибрати **View rule**. Відкриється файл у форматі YML, що лежить у папці відповідного стайлгайда в папці **styles**. У файлі є посилання на це правило в стайлгайді.

![img](/docs/img/vale-rule.png)

### Створення власного стайлгайда

Отже, ми з’ясували, що можемо перевіряти тексти на відповідність стайлгайдам Майкрософт і Гугл. А як щодо власних стайлгайдів? Це також можливо. Можна створювати власні правила та регулярні вирази. Як зразок можете використати існуючі YML-файли правил зі стайлгайдів Майкрософт, Гугл тощо.

Щоб створити власне правило:

1. Створіть папку з назвою вашого власного стайлгайда. Наприклад, **my-styleguide**.

2. Покладіть папку **my-styleguide** до папки **styles** з усіма іншими стайлгайдами.

3. Відкрийте файл конфігурації **.vale.ini** у Блокноті.

4. Додайте назву папки свого стайлгайда **my-styleguide** до переліку стайлгайдів.

    ![img](/docs/img/vale-ini.png)

5. Збережіть файл конфігурації **.vale.ini** у Блокноті.

6. У папці вашого стайлгайда створіть YML-файл правила з такою конфігурацією.

    ![img](/docs/img/rule-1.png)

7. Збережіть його з назвою, наприклад, **rule-1.yml**.

    ![img](/docs/img/vale-rule-1.png)

    Тут ми створюємо правило, щоб Vale нам видавав попередження, якщо написано *web-site* замість *website*, *dou* замість *DOU* та *e-mail* замість *email* незалежно від регістру (великими чи малими літерами).

8. Відкриваємо наш файл Markdown у VSCode.

    ![img](/docs/img/vale-check.png)

    Бачимо, що правило нашого стайлгайда спрацювало: Vale видав усі попередження щодо неправильного написання *web-site*, *e-mail* та *dou*.

## Що далі?

Усі перевірки, що я навів у попередніх розділах стосуються локальних файлів у форматі Markdown. Лінтер Vale, як і лінтери для коду, можна вбудувати в пайплайн CI/CD, щоб під час кожного коміту та пушу (збереження та передача локальних змін на сервер за допомогою git) відбувалася перевірка лінтером Vale. За наявності помилок ви не зможете передати зміни на сервер. Пайплайн CI/CD можна налаштувати для GitHub, GitLab. Особисто я цього не роблю і перевіряю свої файли локально. Однак знаю, що так працюють техрайтерські команди, що пишуть документацію для [GitLab](https://docs.gitlab.com/ee/development/documentation/testing.html#vale), [Spotify](https://github.com/backstage/backstage) та інших продуктів.

До речі, можете зайти в їхні відкриті репозиторії та подивитися конфігурацію перевірок за допомогою лінтера Vale. Крім того, ви можете додати додаткові стайлгайди до моєї конфігурації. Ось перелік доступних репозиторіїв з [офіційно підтримуваними стайлгайдами](https://github.com/errata-ai/styles#available-styles), з яких я брав стайлгайди Майкрософт і Гугл. Переходите за посиланнями до репозиторія і завантажуєте звідти папку з правилами. Наприклад, [цю папку для стайлгайда Joblint](https://github.com/errata-ai/Joblint/tree/master/Joblint). У цьому стайлгайді правила, за якими Vale перевіряє текст описів вакансій на наявність сексизмів, культурних ляпів, рекрутерських фейлів тощо.

Ще одна цікава можливість експериментувати зі створенням правил для Vale — їхній сайт [Vale Studio](https://vale-studio.errata.ai/). Тут можна задати правила та регулярні вирази, а також відразу подивитися результат, як відпрацює правило.

Сподіваюся, що ця стаття допоможе вам автоматизувати перевірку документації на відповідність вимогам стайлгайдів, а також створити власні правила для перевірки лінтером Vale. Пам’ятайте, що людині властиво помилятися, а такі засоби перевірки як Vale допомагають усунути людський фактор.
